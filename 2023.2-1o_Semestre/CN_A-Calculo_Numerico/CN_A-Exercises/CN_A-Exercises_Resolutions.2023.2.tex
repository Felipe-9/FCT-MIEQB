% !TEX root = ./CN_A-Exercises_Resolutions.2023.2.tex
\documentclass["CN_A-Exercises_Resolutions.tex"]{subfiles}

% \tikzset{external/force remake=true} % - remake all

\begin{document}

\graphicspath{{\subfix{./.build/figures/CN_A-Exercises_Resolutions.2023.2}}}
% \tikzsetexternalprefix{./.build/figures/CN_A-Exercises_Resolutions.2023.2/graphics/}

\mymakesubfile{2} [CN A]
{Interpolação e Aproximação Polinomial} % Subfile Title
{Interpolação e Aproximação Polinomial} % Part Title

\setcounter{question}{1}
\begin{questionBox}1{} % Q2

  Determine os polinómios de Lagrange, de grau menor ou igual a 2, interpoladores das seguintes funções:
\begin{enumerate}[label=\alph{enumi})]
  \begin{multicols}{2}
    \item \(f_1(x) = 1/x\) nos pontos: \numlist*{1;2;4}
    \item \(f_2(x) = e^x\) nos pontos: \numlist*{0;1;2}
    \item \(f_3(x) = \ln{\sqrt{x}}\) nos pontos: \(1,e,e^2\)
    \item \(f_4(x) = \sin{x\frac{\pi}{6}}\) nos pontos: \numlist*{1;2;3}
    \item \(f_5(x) = e^{-x}\) nos pontos: \numlist*{0;0.5;1}
    \item \(f_6(x) = \cosh{x}\) nos pontos: \numlist*{-1;0;1}
    \end{multicols}
\end{enumerate}

\end{questionBox}

\begin{questionBox}2{\(f_1(x)=1/x;\{1,2,4\}\)} % Q2.1
  \answer{}

  \begin{gather*}
    % n: 2
    p_{2}(x)
    = \sum_{i=0}^{2}{ y_i\,L_{i}(x) }
    % 
    % 
    % 
    = \frac{1}{1}\,L_0
    + \frac{1}{2}\,L_1
    + \frac{1}{4}\,L_2
    = \\ 
    = 
    \frac{1}{3} ( x^2 -6\,x +8 )
    + \frac{1}{2}\left(-\frac{1}{2} ( x^2 -5\,x +4 )\right)
    + \frac{1}{4} \left( \frac{1}{6} ( x^2 -3\,x +2 )\right)
    % 
    = \\
    x^2\frac{ 1 }{ 8 }
    - x\frac{ 7 }{ 8 }
    + \frac{ 7 }{ 4 }
    % 
    % 
    % 
    ;\\[1ex]
    L_i(x)
    =\prod_{j=0}^{i-1}{\frac{x-x_j}{x_i-x_j}}
    \,\prod_{j=i+1}^{2}{\frac{x-x_j}{x_i-x_j}}
    % 
    % 
    % 
    ;\\[1ex]
    L_0(x)
    =\prod_{j=0}^{0-1}{\frac{x-x_j}{1-x_j}}
    \,\prod_{j=0+1}^{2}{\frac{x-x_j}{1-x_j}}
    = \frac{x-2}{1-2}
    \,\frac{x-4}{1-4}
    = \frac{1}{3} ( x^2 -6\,x +8 )
    % 
    % 
    % 
    ;\\[1ex]
    L_1(x)
    =\prod_{j=0}^{1-1}{\frac{x-x_j}{2-x_j}}
    \,\prod_{j=1+1}^{2}{\frac{x-x_j}{2-x_j}}
    = \frac{x-1}{2-1}
    \,\frac{x-4}{2-4}
    = -\frac{1}{2} ( x^2 -5\,x +4 )
    % 
    % 
    % 
    ;\\[1ex]
    L_2(x)
    =\prod_{j=0}^{2-1}{\frac{x-x_j}{4-x_j}}
    \,\prod_{j=2+1}^{2}{\frac{x-x_j}{4-x_j}}
    = \frac{x-1}{4-1}
    \,\frac{x-2}{4-2}
    = \frac{1}{6} ( x^2 -3\,x +2 )
  \end{gather*}
\end{questionBox}

\begin{questionBox}2{\(f_2(x)=e^x;\{0,1,2\}\)} % Q2.2
  \answer{}
  \begin{gather*}
    % n: 2
    p_{2}(x)
    = \sum_{i=0}^{2}{ y_i\,L_{i}(x) }
    =\dots
    = x^2\,\frac{e^2-2\,e+1}{2}
    - x^1\,\frac{e^2-4\,e+3}{2}
    + 1
    % 
    % 
    % 
    ;\\
    L_{i}(x)
    =\prod_{j=0}^{i-1}{\frac{x-x_j}{x_i-x_j}}
    \,\prod_{j=i+1}^{2}{\frac{x-x_j}{x_i-x_j}}
    \dots
  \end{gather*}
\end{questionBox}

\begin{questionBox}2{\(f_3(x)=\ln\sqrt{x};\{1,e,e^2\}\)} % Q2.3
  \answer{}
  \begin{gather*}
    % n: 2
    p_{2}(x)
    = \sum_{i=0}^{2}{ y_i\,L_{i}(x) }
    = \dots
    = x^2\,\frac{1}{2\,e-2\,e^3}
    + x^1\,\frac{e+1}{2\,e^2-2\,e}
    + x^0\,\frac{e+2}{2-e^2}
    % 
    % 
    % 
    ;\\
    L_{i}(x)
    =\prod_{j=0}^{i-1}{\frac{x-x_j}{x_i-x_j}}
    \,\prod_{j=i+1}^{2}{\frac{x-x_j}{x_i-x_j}}
    \dots
  \end{gather*}
\end{questionBox}

\begin{questionBox}2{\(f_4(x)=\sin{x\frac{\pi}{6}}; \{1,2,3\}\)} % Q2.4
  \answer{}
  \begin{gather*}
    % n: 2
    p_{2}(x)
    = \sum_{i=0}^{2}{ y_i\,L_{i}(x) }
    = \dots
    = x^2\,\frac{3-2\,\sqrt{3}}{4}
    + x^1\,\frac{8\,\sqrt{3}-11}{4}
    + x^0\,\frac{5-3\,\sqrt{3}}{2}
    % 
    % 
    % 
    ;\\
    L_{i}(x)
    =\prod_{j=0}^{i-1}{\frac{x-x_j}{x_i-x_j}}
    \,\prod_{j=i+1}^{2}{\frac{x-x_j}{x_i-x_j}}
  \end{gather*}
\end{questionBox}

\begin{questionBox}2{\(f_5(x)=e^{-x}; \{0.0,0.5,1.0\}\)} % Q2.5
  \answer{}
  \begin{gather*}
    % n: 2
    p_{2}(x)
    = \sum_{i=0}^{2}{ y_i\,L_{i}(x) }
    = \dots
    = x^2\,\frac{2+2/e-4/\sqrt{e}}
    + x^1\,\frac{-3-1/e+4/\sqrt{e}}
    + 1
    % 
    % 
    % 
    ;\\
    L_{i}(x)
    =\prod_{j=0}^{i-1}{\frac{x-x_j}{x_i-x_j}}
    \,\prod_{j=i+1}^{2}{\frac{x-x_j}{x_i-x_j}}
  \end{gather*}
\end{questionBox}

\begin{questionBox}2{\(f_6(x)=\cosh{x}; \{-1,0,1\}\)} % Q2.6
  \answer{}
  \begin{gather*}
    % n: 2
    p_{2}(x)
    = \sum_{i=0}^{2}{ y_i\,L_{i}(x) }
    = \dots
    = x^2\,(\cosh{1}-1)
    + 1
    % 
    % 
    % 
    ;\\
    L_{i}(x)
    =\prod_{j=0}^{i-1}{\frac{x-x_j}{x_i-x_j}}
    \,\prod_{j=i+1}^{2}{\frac{x-x_j}{x_i-x_j}}
  \end{gather*}
\end{questionBox}

\begin{questionBox}1{} % Q3
  Construa o polinómio de Lagrange do segundo grau, interpolador da função \(h(x) = \cos( \pi\,4\,x)\) nos pontos \(x_0 = 0, x_1 = 1 e x_2 = 4\). Determine um valor aproximado de \(h(0.5)\) e um majorante para o erro absoluto cometido (arredondado a 6 casas decimais e tão pequeno quanto possı́vel). Compare-o com o erro efetivamente cometido.
  \answer{}
  \begin{gather*}
    % n: 2
    p_{2}(x)
    = \sum_{i=0}^{2}{ y_i\,L_{i}(x) }
    % 0, 1, 4
    = h(0)\,L_0(0)
    + h(1)\,L_1(1)
    + h(4)\,L_2(4)
    = \\
    = \dots
    = x^2\,\left( \frac{1}{6} -\frac{1}{3\sqrt{2}} \right)
    + x^1\,\left(-\frac{7}{6}+\frac{2\sqrt{2}}{3}\right)
    + 1
    % 
    % 
    % 
    ;\\
    \widehat{h(0.5)}
    \cong p_2(0.5)
    = (1/2)^2\,\left( \frac{1}{6} -\frac{1}{3\sqrt{2}} \right)
    % -0.017258898432212
    + (1/2)^1\,\left(-\frac{7}{6}+\frac{2\sqrt{2}}{3}\right)
    % -0.111928812542302
    + 1
    \cong\num{0.870812289025486}
    % 
    % 
    % 
    ;\\[1ex]
    L_{i}(x)
    =\prod_{j=0}^{i-1}{\frac{x-x_j}{x_i-x_j}}
    \,\prod_{j=i+1}^{2}{\frac{x-x_j}{x_i-x_j}}
  \end{gather*}
\end{questionBox}

\setcounter{question}{6}

\begin{questionBox}1{} % Q7
  Mostre que, sendo \(x_i=i,i=0,1,\dots,n\), se tem \(\sum_{i=0}^{n}{ i\,L_i(x)=x }, \forall{x}\in\mathbb{R}\), onde
  \begin{BM}
    L_i(x) = \frac
    {\prod_{j=0}^{n}{(x  -x_j)}}
    {\prod_{j=0}^{n}{(x_i-x_j)}}
  \end{BM}
  (nota: Escolha convenientemente uma função \(y=f(x)\) a interpolar)
\end{questionBox}

\begin{questionBox}1{} % Q8
  Seja \(f\) uma função da qual se conhece a seguinte tabela de valores:
  \begin{center}
    \vspace{1ex}
    \begin{tabular}{C || *{3}{C}}

      x     & 0.3    & 0.5    & 1.1
      \\ \hline
      f(x)  & 0.5917 & 0.4444 & 0.2268
      % \\\bottomrule
    \end{tabular}
    \vspace{2ex}
  \end{center}
\end{questionBox}

\begin{questionBox}2{} % Q8.1
  Construa a tabela de diferenças dividadas e, a partir dela, determine, por interpolação polinomial quadrática, um valor aproximado de \(f(0.65)\).
  \answer{}
  \sisetup{ 
    round-precision={4},
    round-mode = places
  }
  \begin{center}
    \vspace{1ex}
    \begin{tabular}{C *{3}{C}}
      \toprule

      x 
      & f[\cdot,\cdot] 
      & f[\cdot,\cdot,\cdot]

      \\\midrule
      % x     & 0.3    & 0.5    & 1.1
      % f(x)  & 0.5917 & 0.4444 & 0.2268

      0.3
      & \multirow{2}{*}{\( 
          \frac{0.4444-0.5917}{0.5-0.3}
          =-0.7365 
      \)} % f[0.3,0.5]
      & \multirow{3}{*}{\(
          \frac{f\myrange{0.5,1.1}-f\myrange{0.3,0.5}}{1.1-0.3}
          =\num{0.467291666666667}
      \)} % f[0.3,1.1]
      \\ 0.5
      & \multirow{2}{*}{\(
          \frac{0.2268-0.4444}{1.1-0.5}
          =\num{-0.362666666666667}
      \)} % f[0.5,1.1]
      \\ 1.1

      \\\bottomrule
    \end{tabular}
    \vspace{2ex}
  \end{center}
  \begin{gather*}
    f(0.65) 
    = p_2(0.65)
    \cong \\[1ex]
    \cong 0.5917
    + ((0.65)-0.3)( -0.7365 )
    + ((0.65)^2-0.5\,(0.65)+0.25)( \num{0.467291666666667} )
    \cong \\
    \cong 0.3585
    % 
    % 
    % 
    ; \\[1ex]
    p_2(x)
    = f(x_0)
    + (x-x_0)f\myrange{x_0,x_1}
    + (x-x_0)(x-x_1)f\myrange{x_0,x_1,x_2}
    = \\
    = f(0.3)
    + (x-0.3)f\myrange{0.3,0.5}
    + (x-0.3)(x-0.5)f\myrange{0.3,0.5,1.1}
    \cong \\
    \cong 0.5917
    + (x-0.3)\num{0.467291666666667}
    + (x^2-0.5\,x+0.25)\num{-0.362666666666667}
  \end{gather*}
\end{questionBox}

\begin{questionBox}2{} % Q8.2
  Sabendo que \(
    \myvert{f^{n}(x)}
    \leq\frac
    {(n+1)!}
    {(1+x)^{n+2}}
    ,n\in\mathbb{N}
    ,x\in\myrange{0.3,1.1}
  \) determine majorantes do erro absoluto e do erro relativo (arredondados a 4 casas decimais e tão pequenos quanto possı́vel) associados à aproximação de \(f(0.65)\) calculada em a).

  \answer{}

  \begin{gather*}
    % p_2(0.65) \cong 0.3585
    \text{Erro absoluto:} \\
    \eta_{f(0.65)}
    = \myvert{f(0.65)-p_2(0.65)}
    \leq \dots \\
    \leq 0.0255
    % 
    % 
    % 
    ;\\[1ex]
    \text{Erro relativo:} \\
    r_{f(0.65)}
    = \frac
    { \myvert{f(0.65)-p_2(0.65)} }
    { \myvert{f(0.65)} }
    \leq \frac
    { \myvert{f(0.65)-p_2(0.65)} }
    { 0.333 }
    \cong \dots \\
    \cong \num{0.0766}
    % 
    % 
    % 
    ;\\[1ex]
    f(0.65) \in I
    = \myrange{
      p_2(0.65)-\eta_{f(0.65)},
      p_2(0.65)+\eta_{f(0.65)}
    }
    = \\
    = \myrange{
      p_2(0.65)-\eta_{f(0.65)},
      p_2(0.65)+\eta_{f(0.65)}
    }
    = \dots \\
    = \myrange{
      0.3330,
      0.3840
    }
  \end{gather*}

  % \begin{center}
  %   \includegraphics[width=.8\textwidth]{IMG_8548.png}
  % \end{center}

\end{questionBox}

\begin{questionBox}1{} % Q9

  Seja \(f\) uma função não negativa da qual se conhece a seguinte tabela de valores:
  \begin{center}
    \vspace{1ex}
    \begin{tabular}{C || *{3}{C}}
      % \toprule
      x
      & 3 & 6 & 7
      \\\hline
      f(x)
      & A & 21 & B
      % \\\bottomrule
    \end{tabular}
    \vspace{2ex}
  \end{center}

  Sabe-se que:
  \begin{itemize}
    \begin{multicols}{3}
      \item \(A,B\in\mathbb{R}\)
      \item \(f\myrange{3,6}=A^2-1\)
      \item \(f\myrange{3,6,7}=3\)
      \end{multicols}
  \end{itemize}

  Determine os valores de \textit{A} e \textit{B}

  \answer{}

  \begin{center}
    \vspace{1ex}
    \begin{tabular}{C *{3}{C}}
      \toprule

      x
      & f(x)
      & f[\cdot,\cdot]
      & f[\cdot,\cdot,\cdot]

      \\\midrule

      3 & A 
      % & \multirow{2}{*}{ \( A^2-1 \) }  % f[3,6]
      & \multirow{2}{*}{ \( \frac{21-A}{6-3} \) }  % f[3,6]
      % & \multirow{3}{*}{ \( 3 \) } % f[3,6,7]
      & \multirow{3}{*}{ \( \frac{f\myrange{6,7}-f\myrange{3,6}}{7-3} \) } % f[3,6,7]
      \\ 6 & 21 
      & \multirow{2}{*}{ \( \frac{B-21}{7-6} \) } % f[6,7]
      \\ 7 & B

      \\\bottomrule
    \end{tabular}
    \vspace{2ex}
  \end{center}

  \begin{gather*}
    f\myrange{3,6}
    = A^2-1
    = \frac{21-A}{6-3}
    \implies
    A=8/3 \land A=-3 \land A\in\mathbb{R}^+
    \implies A=8/3
    %
    %
    %
    ; \\[1ex]
    f[3,6,7]
    = 3
    = \frac
    {(B-21)-(A^2-1)}{4}
    = \frac
    {B-21-(8/3)^2+1}{4}
    \implies
    B=352/9
  \end{gather*}

\end{questionBox}

\begin{questionBox}1{} % Q10

  Considere-se uma função real de variável real, \textit{g}, cujos valores se conhecem nos nodos \(x_0=-2, x_1 =-1\text{ e }x_2=1\):
  \begin{center}
    \vspace{1ex}
    \begin{tabular}{C || *{3}{C}}

      x    & -2     & -1    & 1
      \\\hline
      g(x) & \alpha & \beta & \gamma
      % & 1.409297 
      % & 0.900117
      % & 0.474453
      % & -0.506802

    \end{tabular}
    \vspace{2ex}
  \end{center}

\end{questionBox}

\begin{questionBox}1{} % Q11

  Seja \(g(x)\) uma função contı́nua e invertı́vel no intervalo \(\myrange{2,4}\) e da qual se conhecem os seguintes valores (arredondados a 6 casas decimais):
  \begin{center}
    \vspace{1ex}
    \begin{tabular}{C || *{4}{C}}

      x    & 2.0      & 2.6      & 3.0      & 4.0
      \\\hline
      g(x) & 1.409297 & 0.900117 & 0.474453 & −0.506802

    \end{tabular}
    \vspace{2ex}
  \end{center}

\end{questionBox}

\begin{questionBox}2{} % Q11.1

  A função \textit{g} admite um único zero real, \(\alpha\), no intervalo \(\myrange{ 2, 4 }\). Considerando a função inversa de \(g, g^{−1}\), e utilizando a teoria de interpolação polinomial, determine um valor aproximado, \(\widehat{\alpha}\), de \(\alpha\). (Apresente o valor de \(\alpha\) com 6 casas decimais, devidamente arredondados utilizando o mesmo procedimento nos cálculos intermédios).

  \answer{}

  \sisetup{
    exponent-mode={input},
    round-precision={6},
  }
  \begin{gather*}
    \widehat{\alpha} 
    = p_{3,g^{-1}}(0)
    = \\[1ex]
    \cong 2.0
    + \left(\begin{aligned}
        (0-1.409297)
        \,(\num{-1.178365214658863})
        % 1.660666561923092
        \\+ (0-1.409297)
        \,(0-0.900117)
        \,(\num{-0.25529061546065})
        % -0.323844362942087
        \\+ (0-1.409297)
        \,(0-0.900117)
        \,(0-0.474453)
        \,(\num{-0.162685891577465})
        % 0.097913952087755
    \end{aligned}\right)
    \cong\\
    \cong\num{3.43473615106876}
    % 
    % 
    % 
    ; \\[1ex]
    p_{3,g^{-1}}(y)
    = g^{-1}(y_0)
    + \sum_{i=0}^{3-1}{
      \left(\prod_{j=0}^{i}{y-y_j}\right)
      \,g^{-1}_{[y_0,\dots,y_{i+1}]}
    }
    = \\
    = g^{-1}(y_0)
    + \left(\begin{aligned}
        (y-y_0)               & g^{-1}\myrange{y_0,y_1}
        \\+ (y-y_0)(y-y_1)        & g^{-1}\myrange{y_0,y_1,y_2}
        \\+ (y-y_0)(y-y_1)(y-y_2) & g^{-1}\myrange{y_0,y_1,y_2,y_3}
    \end{aligned}\right)
    = \\
    = 2.0
    + \left(\begin{aligned}
        (y-1.409297)
        \,(\num{-1.178365214658863})
        \\+ (y-1.409297)
        \,(y-0.900117)
        \,(\num{-0.25529061546065})
        \\+ (y-1.409297)
        \,(y-0.900117)
        \,(y-0.474453)
        \,(\num{-0.162685891577465})
    \end{aligned}\right)
  \end{gather*}

  \begin{center}
    \setlength\tabcolsep{3mm}        % width
    % \renewcommand\arraystretch{1.25} % height
    \vspace{1ex}
    \begin{tabular}{C *{4}{C}}
      \toprule

      y & g^{-1}(y) 
      & g^{-1}[\cdot,\cdot] 
      & g^{-1}[\cdot,\cdot,\cdot]
      & g^{-1}[\cdot,\cdot,\cdot,\cdot]

      \\\midrule

      1.409297 & 2.0
      & \multirow[m]{2}{*}{\( \num{-1.178365214658863}  \)}
      & \multirow[m]{3}{*}{\( \num{-0.25529061546065}  \)}
      & \multirow[m]{4}{*}{\( \num{-0.162685891577465}  \)}
      \\ 0.900117 & 2.6
      & \multirow[m]{2}{*}{\( \num{-0.939708314539167} \)}
      & \multirow[m]{3}{*}{\( \num{0.05643165870504} \)}
      \\ 0.474453 & 3.0
      & \multirow[m]{2}{*}{\( \num{-1.019103087372803} \)}
      \\ −0.506802 & 4.0

      \\\bottomrule
    \end{tabular}
    \vspace{2ex}
  \end{center}

  \begin{gather*}
    g^{-1}\myrange{y_0,y_1}
    = \frac{2.6-2.0}{0.900117-1.409297}
    \cong\num{-1.178365214658863}
    % 
    % 
    % 
    ; \\[1ex]
    g^{-1}\myrange{y_1,y_2}
    = \frac{3.0-2.6}{0.474453-0.900117}
    \cong \num{-0.939708314539167}
    % 
    % 
    % 
    ; \\[1ex]
    g^{-1}\myrange{y_2,y_3}
    = \frac{4.0-3.0}{-0.506802-0.474453}
    \cong \num{-1.019103087372803}
    % 
    % 
    % 
    ; \\[1ex]
    g^{-1}\myrange{y_0,y_1,y_2}
    = \frac{
      \num{-0.939708314539167}
      +\num{1.178365214658863}
    }{0.474453-1.409297}
    \cong \num{-0.25529061546065}
    % 
    % 
    % 
    ; \\[1ex]
    g^{-1}\myrange{y_1,y_2,y_3}
    = \frac{
      \num{-1.019103087372803}
      +\num{0.939708314539167}
    }{−0.506802-0.900117}
    \cong \num{0.05643165870504}
    % 
    % 
    % 
    ; \\[1ex]
    g^{-1}\myrange{y_0,y_1,y_2,y_3}
    = \frac{
      \num{0.05643165870504}
      +\num{0.25529061546065}
    }{−0.506802-1.409297}
    \cong \num{-0.162685891577465}
  \end{gather*}

\end{questionBox}

\begin{questionBox}2{} % Q11.2

  Sabendo que \(g(x) = sin(x) + 1/x\) e que \(\alpha = 3.436828912\dots\), indique majorantes (com 6 casas decimais e tão pequenos quanto possı́vel), para \(\myvert{\epsilon_\alpha}\text{ e }r_\alpha\)

  \answer{}

  \sisetup{
    exponent-mode={fixed},
    fixed-exponent={0},
    round-precision={6},
    round-direction={up},
  }

  \begin{gather*}
    \myvert{\epsilon_\alpha} 
    = \myvert{\widehat{\alpha}-\alpha}
    \leq \myvert{\num{3.43473615106876}-\num{3.436828912}}
    \cong\num{2.09276093124e-3}
    % 
    % 
    % 
    ; \\[1ex]
    r_{\alpha}
    = \frac
    { \myvert{\epsilon_\alpha} }
    { \myvert{\alpha} }
    \leq
    \frac{\num{2.09276093124e-3}}
    {\num{3.436828912}}
    \cong
    \num{0.608922057171055e-3}
  \end{gather*}

\end{questionBox}

\setcounter{question}{13}
\begin{questionBox}1{} % Q14

  Considere a função seccionalmente polinomial, \(S(x)\), definida por:
  \begin{BM}
    \begin{cases}
      x^2                ,\quad& -1\leq x<0
      \\ a\,x^3+b\,x^2+c\,x ,\quad&  0\leq x<1
      \\ 2-x                ,\quad&  1\leq x\leq 2
    \end{cases}
  \end{BM}
  Onde \(a, b\text{ e }c\) são constantes reais.
  \\ Diga, justificando, se \(S(x)\) pode ser um spline cúbico.

  \answer{}

  % TODO: Conferir e terminar o paco a paco da questão
  % TODO: Fazer snippet para resolução

  \begin{gather*}
    S\text{ é Spline Cúbico}
    \impliedby
    \exists\{a,b,c\}:
    \begin{cases}
      \color{EmphA22}\lim_{x\to0^-}{                 S(x) }     &\color{EmphA22}= \lim_{x\to0^+}{               S(x) }
      \\ \color{EmphA11}\lim_{x\to1^-}{                 S(x) }     &\color{EmphA11}= \lim_{x\to1^+}{               S(x) }
      \\ \color{EmphA13}\lim_{x\to0^-}{\odv{            S(x) }{x}} &\color{EmphA13}= \lim_{x\to0^+}{\odv{          S(x) }{x}}
      \\ \color{EmphA15}\lim_{x\to1^-}{\odv{            S(x) }{x}} &\color{EmphA15}= \lim_{x\to1^+}{\odv{          S(x) }{x}}
      \\ \color{EmphA17}\lim_{x\to0^-}{\odv[order = 2]{ S(x) }{x}} &\color{EmphA17}= \lim_{x\to0^+}{\odv[order=2]{ S(x) }{x}}
      \\ \color{EmphA19}\lim_{x\to1^-}{\odv[order = 2]{ S(x) }{x}} &\color{EmphA19}= \lim_{x\to1^+}{\odv[order=2]{ S(x) }{x}}
    \end{cases}
    %
    %
    %
    \\[1ex] \color{EmphA22}
    % 1
    \lim_{x\to0^-}{S(x)}
    = 0^2
    = 0
    = \\ \color{EmphA22}
    = \lim_{x\to0^+}{S(x)}
    = a\,0^3+b\,0^2+c\,0
    = 0
    % 
    % 
    % 
    ; \\[1ex] \color{EmphA11}
    % 2
    \lim_{x\to1^-}{S(x)}
    = a\,1^3+b\,1^2+c\,1
    = a+b+c
    = \\ \color{EmphA11}
    = \lim_{x\to1^+}{S(x)}
    = 2-1
    = 1
    % 
    % 
    % 
    ; \\[1ex]
    % 
    \odv{S(x)}{x}
    = \begin{cases}
      2\,x                ,\quad& -1\leq x<0
      \\ 3\,a\,x^2+2\,b\,x+c ,\quad& 0\leq x<1
      \\ -1                  ,\quad& 1\leq x\leq 2
    \end{cases}
    % 
    % 
    % 
    \\[1ex] \color{EmphA13}
    % 3
    \lim_{x \to 0^-}{\odv{S(x)}{x}}
    = 2*0
    = 0
    = \\ \color{EmphA13}
    % 
    = \lim_{x \to 0^+}{\odv{S(x)}{x}}
    = 3\,a\,0^2+2\,b\,0+c
    = c
    \implies c=0
    % 
    % 
    % 
    ; \\[1ex] \color{EmphA15}
    % 4
    \lim_{x\to1^-}{\odv{S(x)}{x}}
    = 3\,a\,1^2+2\,b\,1+c
    = 3\,a+2\,b
    % 
    = \\ \color{EmphA15}
    %
    = \lim_{x\to1^+}{\odv{S(x)}{x}}
    = -1
    \implies \\ \color{EmphA15}
    \implies
    3\,a+2\,b
    =-1
    % 
    % 
    % 
    ; \\[1ex]
    % 
    \odv[order=2]{S(x)}{x}
    = \begin{cases}
      2            ,\quad& -1\leq x<0
      \\ 6\,a\,x+2\,b ,\quad& 0\leq x<1
      \\ 0            ,\quad& 1\leq x\leq 2
    \end{cases}
    % 
    % 
    % 
    \\[1ex] \color{EmphA17}
    % 5
    \lim_{x\to0^-}{\odv[order=2]{S(x)}{x}}
    = 2
    = \lim_{x\to0^+}{\odv[order=2]{S(x)}{x}}
    = 6\,a\,0+2\,b
    = 2\,b
    \implies b=1
    % 
    % 
    % 
    % ; \\[1ex] \color{EmphA19}
    % % 
    % \lim_{x\to1^-}{\odv[order=2]{S(x)}{x}}
    % = 6\,a\,1+2\,b
    % = 6\,a+2
    % = \lim_{x\to1^+}{\odv[order=2]{S(x)}{x}}
    % =0
    % \implies
    % a=-1/3
    \\[1ex]
    \implies\begin{cases}
      \color{EmphA11} a+b+c=1
      \\ \color{EmphA13} c=0 \implies b=1-a
      \\ \color{EmphA15} 3\,a+2\,b = -1
      \implies \begin{cases}
        a = \frac{-1-2\,(1-a)}{3} \implies a = -3
        \\ b = 1-(-3) = 4
      \end{cases}
      \\ \color{EmphA17} b=1
      \color{EmphA15} \neq 4
      % \\ b=1
      % \\ 6\,a+2\,b=0 \implies 2=0
    \end{cases}
    \\ 
    \therefore S(x)\text{ não pode ser spline}
  \end{gather*}

\end{questionBox}

\begin{questionBox}1{} % Q15

  Considere a seguinte tabela de valores de uma função \textit{g}
  \begin{center}
    \vspace{1ex}
    \begin{tabular}{C || *{4}{C}}
      % \toprule

      x & 1 & 2 & 4 & 8

      \\\hline
      % \\\midrule

      g(x)
      & -2 & 6 & 2 & 40

      % \\\bottomrule
    \end{tabular}
    \vspace{2ex}
  \end{center}
  Determine a expressão do spline cúbico natural, \(S(x)\), interpolador de \(g(x)\) nos pontos tabelados.

  \answer{}
  \begin{gather*}
    \left\{
      \begin{aligned}
        h_0\,m_0
        + 2\,(h_0+h_1)\,m_1
        + h_1\,m_2
        = 6\left(
          \frac{y_2-y_1}{h_1}
          -\frac{y_1-y_0}{h_0}
        \right)
        \\
        h_1\,m_1
        + 2\,(h_1+h_2)\,m_2
        + h_2\,m_3
        = 6\left(
          \frac{y_3-y_2}{h_2}
          -\frac{y_2-y_1}{h_1}
        \right)
        \\
        m_0=m_3=0;
        \\
        h_i=x_{i+1}-x_i,\quad i\in\myrange{0,2}
        \\
        h_0=1,
        h_1=2,
        h_2=4
        \\
        y_0=- 2,
        y_1=  6,
        y_2=  2,
        y_3= 40
      \end{aligned}
    \right\}
    = \\
    = \left\{
      \begin{aligned}
        2*(1+2)\,m_1
        + 2\,m_2
        = 6\left(
          \frac{2-6}{2}
          -\frac{6+2}{1}
        \right)
        \\
        2\,m_1
        + 2\,(2+4)\,m_2
        = 6\left(
          \frac{40-2}{4}
          -\frac{2-6}{2}
        \right)
      \end{aligned}
    \right\}
    = \\
    = \left\{
      \begin{aligned}
        6\,m_1
        + 2\,m_2
        = -60
        \\
        2\,m_1
        + 12\,m_2
        = 69
      \end{aligned}
    \right\}
    \implies \\
    \implies
    \begin{bmatrix}
      6 & 2
      \\ 2 & 12
    \end{bmatrix}
    \begin{bmatrix}
      m_1\\m_2
    \end{bmatrix}
    = \begin{bmatrix}
      -60\\69
    \end{bmatrix}
  \end{gather*}

  \begin{gather*}
    S_i(x)
    = -\frac{(x-x_{i+1})^3}{6\,h_i}
    \,m_i
    + \frac{(x-x_i)^3}{6\,h_i}
    \,m_{i+1}
    + \\
    + \left(
      f_i
      - \frac{h_i^2}{6}m_{i}
    \right)
    \,\frac{x_{i+1}-x}{h_i}
    + \left(
      f_{i+1}
      - \frac{h_i^2}{6}m_{i+1}
    \right)
    \,\frac{x-x_{i}}{h_i}
    ;\\[1ex]
    \begin{cases}
      h_0\,m_0
      + 2\,(h_0+h_1)\,m_1
      + h_1\,m_2
      = 6\left(
        \frac{y_2-y_1}{h_1}
        -\frac{y_1-y_0}{h_0}
      \right)
      \\
      h_1\,m_1
      + 2\,(h_1+h_2)\,m_2
      + h_2\,m_3
      = 6\left(
        \frac{y_3-y_2}{h_2}
        -\frac{y_2-y_1}{h_1}
      \right)
    \end{cases}
  \end{gather*}

\end{questionBox}

\setcounter{question}{18}
\begin{questionBox}1{} % Q19

  Considere a tabela de valores da função \textit{f}
  \begin{center}
    \vspace{1ex}
    \begin{tabular}{C || *{3}{C}}

      x_i
      & -3 & 0 & 2

      \\\hline

      f(x_i)
      & 2 & 4 & 12
    \end{tabular}
    \vspace{2ex}
  \end{center}

\end{questionBox}

\begin{questionBox}2{} % Q19.1

  Determine o polinómio de grau menor ou igual a 1 que melhor aproxima a função tabelada no sentido dos mínimos quadrados, no intervalo \(\myrange{-3,2}\)

  \answer{}

  \begin{gather*}
    \begin{cases}
      a_0\,\sum_{i=0}^{2}{1}
      + a_1\,\sum_{i=0}^{2}{x_i}
      = \sum_{i=0}^{2}{y_i}
      \\
      a_0\,\sum_{i=0}^{2}{x_i}
      + a_1\,\sum_{i=0}^{2}{x_i^2}
      = \sum_{i=0}^{2}{y_i\,x_i}
    \end{cases}
    = \begin{cases}
      a_0\,(3)
      + a_1\,(-1)
      = 18
      \\
      a_0\,(-1)
      + a_1\,(13)
      = 18
    \end{cases}
    = \\
    = \begin{cases}
      a_0 = 126/19
      \\
      a_1 = 36/19
    \end{cases}
    \implies \\
    \implies
    p_1(x)
    = 126/19 + x\,36/19
  \end{gather*}

\end{questionBox}

\begin{questionBox}2{} % Q19.2

  Mostre que
  \begin{BM}
    \sum_{i=0}^2{
      (
        f(x_i)
        -(\gamma_1\,x_i+\gamma_0)
      )^2
    }\geq 200/19
    ,\forall\,\gamma_0,\gamma_1\in\mathbb{R}
  \end{BM}

  \answer{}

  \begin{gather*}
    \sum_0^2{
      \left(
        f(x_i)
        - p_1(x_i)
      \right)^2
    }
    = \dots
  \end{gather*}

\end{questionBox}

\begin{questionBox}2{} % Q19.3

  Seja \(p_2(x)\) o polinomio de grau menor ou igual a 2 interpolador de \textit{f} nos pontos tabelados.\\
  Justifique que a aproximação quadrática que melhor aproxima o conjunto de pontos \(\left\{ (-3,2), (0,4), (2,12)\right\}\) , no sentido dos mínimos quadrados, é o polinómio \(p_2\).

  \answer{}

  \begin{center}
    \vspace{1ex}
    \begin{tabular}{*{4}{C}}
      \toprule

      x & f(x) 
      & f[\cdot,\cdot] 
      & f[\cdot,\cdot,\cdot] 

      \\\midrule

      -3 & 2 & 
      \multirow{2}{*}{
        \(\frac{4-2}{0-(-3)}=2/3\)
      }
      & \multirow{3}{*}{
        \(\frac{4-2/3}{2-(-3)}=2/3\)
      }
      \\
      0 & 4 & 
      \multirow{2}{*}{
        \(\frac{12-4}{2-0}=4\)
      }
      \\
      2 & 12

      \\\bottomrule
    \end{tabular}
    \vspace{2ex}
  \end{center}

  \begin{gather*}
    p_2(x)
    = 2
    + (x+3)\,2/3
    + (x+3)\,(x-0)\,2/3
    \text{ é polinómio de 2 grau}
  \end{gather*}

\end{questionBox}

\setcounter{question}{17}
\begin{questionBox}1{} % Q18

  A seguinte tabela represetna a população da China (em milhares de milhões de habitantes) arredondada a 5 dígitos:
  \begin{center}
    \vspace{1ex}
    \begin{tabular}{L || *{4}{C}}
      % \toprule

      t & 1990 & 2000 & 2010 & 2020

      \\\hline

      P(t) 
      & 1.1769,
      & 1.2906,
      & 1.3688,
      & 1.4393,

      % \\\bottomrule
    \end{tabular}
    \vspace{2ex}
  \end{center}
  Suponha que há uma relação linear entre a data \textit{t} (em anos) e a população \(P(t)\), isto é, que se verifica a relação \(p_1(t) = \alpha\,t + \beta\), onde \(\alpha\) e \(\beta\) são constantes reais (\(\alpha\neq0\)). Com base nestes dados, utilize o método dos mínimos quadrados para obter uma estimativa da população chinesa em 2015.

  \answer{}

  \begin{gather*}
    t\begin{cases}
      0: 1990,
      \\ 1: 2000,
      \\ 2: 2010,
      \\ 3: 2020,
    \end{cases}
    ;\\[1ex]
    N\,C
    = \begin{bmatrix}
      \sum_{i=0}^{3}{t_i^0}
      & \sum_{i=0}^{3}{t_i^1}
      \\ \sum_{i=0}^{3}{t_i^1}
      &  \sum_{i=0}^{3}{t_i^2}
    \end{bmatrix}
    \,\begin{bmatrix}
      \beta\\alpha
    \end{bmatrix}
    = \begin{bmatrix}
      4
      & 8020
      \\ 8020
      & 16080600
    \end{bmatrix}
    \,\begin{bmatrix}
      \beta\\\alpha
    \end{bmatrix}
    = \\[1ex]
    = B
    = \begin{bmatrix}
      \sum_{i=0}^{3}{P(t_i)}
      \\ \sum_{i=0}^{3}{t_i\,P(t_i)}
    \end{bmatrix}
    = \begin{bmatrix}
      5.2756
      \\ 10581.905
    \end{bmatrix}
    ; \\[1ex]
    \therefore
    \begin{cases}
      \alpha\approx  0.00865
      \\ \beta\approx-16.0324
    \end{cases}
    ; \\[1ex]
    p_1(2015) \approx 1.39735
  \end{gather*}

\end{questionBox}

\begin{questionBox}1{} % Q19

  Considere a tabela de valores da função \textit{f}
  \begin{center}
    \vspace{1ex}
    \begin{tabular}{L || *{3}{C}}
      % \toprule

      x_i
      & -3
      & 0
      & 2

      \\\hline

      f(x_i)
      & 2
      & 4
      & 12

      % \\\bottomrule
    \end{tabular}
    \vspace{2ex}
  \end{center}

\end{questionBox}

\begin{questionBox}2{} % Q19.1

  Determine o polinómio de grau menor ou igual a 1 que melhor aproxima a função tabelada, no sentido dos mínimos quadrados, no intervalo \(\myrange{-3,2}\).

  \answer{}

  \begin{gather*}
    p_i(x)= c_o+c_1\,x
    ; \\[1ex]
    N\,C
    = \begin{bmatrix}
      \sum_{i=0}^{2}{x_i^0}
      &  \sum_{i=0}^{2}{x_i^1}
      \\ \sum_{i=0}^{2}{x_i^1}
      &  \sum_{i=0}^{2}{x_i^2}
    \end{bmatrix}
    \,\begin{bmatrix}
      c_0 & c_1
    \end{bmatrix}
    = \begin{bmatrix}
      3
      &  -1
      \\ -1
      &  13
    \end{bmatrix}
    \,\begin{bmatrix}
      c_0 & c_1
    \end{bmatrix}
    = \\[1ex]
    = B
    = \begin{bmatrix}
      \sum_{i=0}^{2}{f(x_i)}
      \\ \sum_{i=0}^{2}{x_i\,f(x_i)}
    \end{bmatrix}
    = \begin{bmatrix}
      18 \\ 18
    \end{bmatrix}
    % \implies \\
    \implies
    c\begin{cases}
      0: 126/19
      \\ 1:36/19
    \end{cases}
    \\[1ex]
    \therefore
    p_1(x)
    = 126/19 + x\,36/19
  \end{gather*}

\end{questionBox}

\begin{questionBox}2{} % Q19.2

  Mostre que
  \begin{BM}
    \sum_{i=0}^{2}{\left(
        f(x_i)
        - (\gamma_1\,x_i+\gamma_0)
    \right)^2}
    \geq 200/19,
    \quad\forall\,\gamma_0,\gamma_1\in\mathbb{R}
  \end{BM}

  \answer{}

  \sisetup{
    % scientific / engineering / input / fixed
    exponent-mode           = fixed,
    round-mode              = places,        % figures/places/unsertanty/none
    round-precision         = 6,
  }
  \begin{gather*}
    % \sum_{i=0}^{2}{\left(
    %     f(x_i)
    %     - (\gamma_1\,x_i+\gamma_0)
    % \right)^2}
    % \geq 200/19
    p_1(x)\in\left\{
      \gamma_1\,x+\gamma_0,\gamma_0\in\mathbb{R}
    \right\}
    % ; \\
    ;\quad
    p_1\text{ Minimiza o erro quadrático } E^2
    \\[1ex]
    E^2
    = \sum_{i=0}^{2}{\left(
        f(x_i)-p_i(x_i)
    \right)^2}
    = \left(
      \begin{aligned}
        &     (2  - \num{0.9473684210526315})^2
        &+\\+& (4  - \num{6.631578947368421})^2
        &+\\+& (12 - \num{10.421052631578947})^2
        &
      \end{aligned}
    \right)
    \cong \num{10.526315789473689}
  \end{gather*}

\end{questionBox}

\begin{questionBox}2{} % Q19.3

  Seja \(p_2(x)\) o polinómio de grau menor ou igual a 2 interpolador de \textit{f} nos pontos tabelados.\\
  Justifique que a aproximação quadrática que melhor aproxima o conjunto de pontos \(\{(-3,2),(0,4),(2,12)\}\), no sentido dos mínimos quadrados, é o polinomio \(p_2\)

  \answer{}

  \begin{center}
    \vspace{1ex}
    \begin{tabular}{C *{3}{C}}
      \toprule

      x_i 
      & f(x_i)
      & f[.]
      & f[..]

      \\\midrule

      -3 & 2
      & \multirow{2}{*}{2/3}
      & \multirow{3}{*}{2/3}
      \\
      0 & 4 
      & \multirow{2}{*}{4}
      \\
      2 & 12

      \\\bottomrule
    \end{tabular}
    \vspace{2ex}
  \end{center}

\end{questionBox}

\end{document}
